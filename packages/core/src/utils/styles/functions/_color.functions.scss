@use 'sass:list';
@use '../variables/theme.variables';

// @function tp-color($color, $variation: null, $opacity: null);
// @param $color: string
// @param $variation: number
// @param $opacity: number
//
// @examples:
// tp-color(brand) @returns: hsl(var(--tp-color-brand));
// tp-color(brand, 5) @returns: hsl(var(--tp-color-brand-5));
// tp-color(brand, 5, 0.5) @returns: hsla(var(--tp-color-brand-5), 0.5);
@function tp-color($color, $variation: null, $opacity: null) {
  @if ($opacity) {
    @return if(
      $variation,
      hsla(var(--tp-color-#{$color}-#{$variation}), $opacity),
      hsla(var(--tp-color-#{$color}), $opacity)
    );
  }

  @return if(
    $variation,
    hsl(var(--tp-color-#{$color}-#{$variation})),
    hsl(var(--tp-color-#{$color}))
  );
}

// @function tp-color-contrast($type, $variation: null, $color: null);
// @param $type: color | neutral | feedback
// @param $color: string
// @param $variation: number
//
// @examples:
// tp-color-contrast(color); @returns: hsl(var(--tp-color-contrast-fixed));
// tp-color-contrast(color, 3); @returns: hsl(var(--tp-color-contrast-fixed));
// tp-color-contrast(color, 2); @returns: hsl(var(--tp-color-neutral-10));
// tp-color-contrast(color, 4); @returns: hsl(var(--tp-color-neutral-1));
//
// tp-color-contrast(feedback); @returns: hsl(var(--tp-color-neutral-1));
//
// tp-color-contrast(neutral, 5, neutral); @returns: hsl(var(--tp-color-neutral-10));
// tp-color-contrast(neutral, 6, neutral); @returns: hsl(var(--tp-color-neutral-1));
// tp-color-contrast(neutral, 55, alternative); @returns: hsl(returns: var(--tp-color-neutral-10));
// tp-color-contrast(neutral, 65, alternative); @returns: hsl(returns: var(--tp-color-neutral-1));
//
@function tp-color-contrast($type, $variation: null, $color: null) {
  @if not list.index(theme.$tp-color-system-types, $type) {
    @error "#{$type} não é um tipo valido. Use uma das variações: #{theme.$tp-color-system-types}.";
  }

  /* stylelint-disable max-nesting-depth */
  @if $type == color {
    @if not $variation or $variation == 3 {
      @return hsl(var(--tp-color-contrast-fixed));
    }

    @if $variation {
      @if not list.index(theme.$tp-color-variation, $variation) {
        @error "#{$variation} não é uma variação valida de 'color'. Use uma das variações: #{theme.$tp-color-variation}.";
      }

      @if $variation <= 2 {
        @return hsl(var(--tp-color-neutral-10));
      } @else {
        @return hsl(var(--tp-color-neutral-1));
      }
    }
  }

  @if $type == feedback {
    @return hsl(var(--tp-color-neutral-1));
  }

  @if $type == neutral {
    @if not $color {
      @error "neutral precisa ter uma das seguintes cores 'neutral' | 'alternative'";
    }

    @if $color == neutral {
      @if not list.index(theme.$tp-neutral-variation, $variation) {
        @error "#{$variation} não é uma variação valida de 'neutral'. Use uma das variações: #{theme.$tp-neutral-variation}.";
      }

      @return if(
        $variation <= 5,
        hsl(var(--tp-color-neutral-10)),
        hsl(var(--tp-color-neutral-1))
      );
    }

    @if $color == alternative {
      @if not list.index(theme.$tp-neutral-alternative-variation, $variation) {
        @error "#{$variation} não é uma variação valida de 'alternative'. Use uma das variações: #{theme.$tp-neutral-alternative-variation}.";
      }

      @return if(
        $variation <= 55,
        hsl(var(--tp-color-neutral-10)),
        hsl(var(--tp-color-neutral-1))
      );
    }
  }
  /* stylelint-enable max-nesting-depth */
}
